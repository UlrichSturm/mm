# –†–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: Epic 1, Epic 2, Phase 0

**–î–∞—Ç–∞:** 2025-12-03  
**–¢–µ—Å—Ç–∏—Ä–æ–≤—â–∏–∫:** AI Assistant  
**–°—Ç–∞—Ç—É—Å:** –í –ø—Ä–æ—Ü–µ—Å—Å–µ

---

## üìã –ü–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### Epic 1: Authentication & Authorization

#### 1.1 Health Check

- [ ] `GET /api/auth/health` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–∞

#### 1.2 –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è

- [ ] `POST /api/auth/register` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Client –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- [ ] `POST /api/auth/register` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Vendor –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è email —Ñ–æ—Ä–º–∞—Ç–∞
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ email
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Keycloak
- [ ] –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î
- [ ] –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–æ–ª–∏ –≤ Keycloak

#### 1.3 –õ–æ–≥–∏–Ω

- [ ] `POST /api/auth/login` - –ª–æ–≥–∏–Ω —Å –≤–∞–ª–∏–¥–Ω—ã–º–∏ credentials
- [ ] `POST /api/auth/login` - –ª–æ–≥–∏–Ω —Å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º–∏ credentials (401)
- [ ] –í–æ–∑–≤—Ä–∞—Ç access_token –∏ refresh_token
- [ ] –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –ë–î

#### 1.4 Keycloak Guards

- [ ] –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ endpoints —Ç—Ä–µ–±—É—é—Ç —Ç–æ–∫–µ–Ω
- [ ] `401 Unauthorized` –¥–ª—è –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤
- [ ] `403 Forbidden` –¥–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö —Ä–æ–ª–µ–π
- [ ] `@Public()` –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö endpoints

#### 1.5 RBAC

- [ ] –†–æ–ª–∏: CLIENT, VENDOR, ADMIN
- [ ] `@Roles()` –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] RoleGuard –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–æ–ª–∏ –∏–∑ Keycloak —Ç–æ–∫–µ–Ω–∞

---

### Epic 2: User Profile

#### 2.1 –ü—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–æ—Ñ–∏–ª—è

- [ ] `GET /api/auth/profile` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è (—Ç—Ä–µ–±—É–µ—Ç auth)
- [ ] –í–æ–∑–≤—Ä–∞—Ç –≤—Å–µ—Ö –ø–æ–ª–µ–π –ø—Ä–æ—Ñ–∏–ª—è
- [ ] –í–∫–ª—é—á–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–æ–≤ –¥–æ—Å—Ç–∞–≤–∫–∏ –∏ –±–∏–ª–ª–∏–Ω–≥–∞
- [ ] `401 Unauthorized` –±–µ–∑ —Ç–æ–∫–µ–Ω–∞

#### 2.2 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è

- [ ] `PATCH /api/auth/profile` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ firstName, lastName, phone
- [ ] `PATCH /api/auth/profile` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ deliveryAddress
- [ ] `PATCH /api/auth/profile` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ billingAddress
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã—Ö –ø–æ–ª–µ–π (–Ω–µ –æ—á–∏—â–∞–µ—Ç country defaults)
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª–µ–π

#### 2.3 –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è

- [ ] `PATCH /api/auth/password` - —Å–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è —Å –≤–∞–ª–∏–¥–Ω—ã–º —Ç–µ–∫—É—â–∏–º –ø–∞—Ä–æ–ª–µ–º
- [ ] `PATCH /api/auth/password` - –æ—à–∏–±–∫–∞ –ø—Ä–∏ –Ω–µ–≤–µ—Ä–Ω–æ–º —Ç–µ–∫—É—â–µ–º –ø–∞—Ä–æ–ª–µ
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–∞—Ä–æ–ª—è (–º–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤)
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è –≤ Keycloak —á–µ—Ä–µ–∑ Admin API

#### 2.4 –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–∫–∞–∑–æ–≤

- [ ] `GET /api/orders/my` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- [ ] –ü–∞–≥–∏–Ω–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å—É
- [ ] –¢–æ–ª—å–∫–æ –∑–∞–∫–∞–∑—ã —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

### Phase 0: External Services & Infrastructure

#### 3.1 Keycloak

- [ ] Keycloak –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—â–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω
- [ ] Realm –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] Client –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] –†–æ–ª–∏ —Å–æ–∑–¥–∞–Ω—ã
- [ ] Admin API –¥–æ—Å—Ç—É–ø–µ–Ω

#### 3.2 Docker

- [ ] –í—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∑–∞–ø—É—â–µ–Ω—ã
- [ ] –°–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 3001
- [ ] Keycloak –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 8080
- [ ] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–∞
- [ ] Redis –¥–æ—Å—Ç—É–ø–µ–Ω

#### 3.3 Swagger UI

- [ ] Swagger UI –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ `/api/docs`
- [ ] –í—Å–µ endpoints –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
- [ ] –°—Ö–µ–º—ã DTO –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
- [ ] –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞—é—Ç

#### 3.4 Database

- [ ] Prisma –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
- [ ] –°—Ö–µ–º–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∫–æ–¥—É
- [ ] –ü–æ–ª–µ avatar —É–¥–∞–ª–µ–Ω–æ –∏–∑ –ë–î (–º–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞)

#### 3.5 Security

- [ ] HSTS –≤–∫–ª—é—á–µ–Ω –≤ production, –æ—Ç–∫–ª—é—á–µ–Ω –≤ development
- [ ] Helmet middleware —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### Epic 1: Authentication & Authorization

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–û–ô–î–ï–ù–û**

#### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:

- ‚úÖ `GET /api/auth/health` - —Ä–∞–±–æ—Ç–∞–µ—Ç (HTTP 200)
- ‚úÖ `POST /api/auth/register` - –¥–æ—Å—Ç—É–ø–µ–Ω –≤ Swagger
- ‚úÖ `POST /api/auth/login` - –¥–æ—Å—Ç—É–ø–µ–Ω –≤ Swagger
- ‚úÖ `GET /api/auth/profile` - –∑–∞—â–∏—â–µ–Ω (HTTP 401 –±–µ–∑ —Ç–æ–∫–µ–Ω–∞)
- ‚úÖ `PATCH /api/auth/profile` - –∑–∞—â–∏—â–µ–Ω (HTTP 401 –±–µ–∑ —Ç–æ–∫–µ–Ω–∞)
- ‚úÖ –í—Å–µ 5 endpoints –¥–æ—Å—Ç—É–ø–Ω—ã –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- ‚úÖ Keycloak Guards —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### Epic 2: User Profile

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–û–ô–î–ï–ù–û**

#### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:

- ‚úÖ `GET /api/auth/profile` - –¥–æ—Å—Ç—É–ø–µ–Ω, –∑–∞—â–∏—â–µ–Ω
- ‚úÖ `PATCH /api/auth/profile` - –¥–æ—Å—Ç—É–ø–µ–Ω, –∑–∞—â–∏—â–µ–Ω
- ‚úÖ `PATCH /api/auth/password` - –¥–æ—Å—Ç—É–ø–µ–Ω, –∑–∞—â–∏—â–µ–Ω
- ‚úÖ `GET /api/orders/my` - –¥–æ—Å—Ç—É–ø–µ–Ω
- ‚úÖ UpdateProfileDto —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –ø–æ–ª—è –∞–¥—Ä–µ—Å–æ–≤ (delivery/billing)
- ‚úÖ Avatar —É–¥–∞–ª–µ–Ω –∏–∑ DTO (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ: false)
- ‚úÖ ChangePasswordDto –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (currentPassword, newPassword)
- ‚úÖ Endpoints –∑–∞—â–∏—â–µ–Ω—ã (HTTP 401 –±–µ–∑ —Ç–æ–∫–µ–Ω–∞)

### Phase 0: External Services

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–û–ô–î–ï–ù–û**

#### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:

- ‚úÖ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã: 7 —Å–µ—Ä–≤–∏—Å–æ–≤ –∑–∞–ø—É—â–µ–Ω—ã
  - mm-server (–ø–æ—Ä—Ç 3001)
  - mm-keycloak (–ø–æ—Ä—Ç 8080)
  - mm-postgres (–ø–æ—Ä—Ç 5432)
  - mm-redis (–ø–æ—Ä—Ç 6379)
  - mm-grafana (–ø–æ—Ä—Ç 3004)
  - mm-mailhog-dev (–ø–æ—Ä—Ç 1025, 8025)
  - mm-minio-dev (–ø–æ—Ä—Ç 9000-9001)
- ‚úÖ Swagger UI –¥–æ—Å—Ç—É–ø–µ–Ω (HTTP 200 –Ω–∞ `/api/docs`)
- ‚úÖ Keycloak –∑–∞–ø—É—â–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–∞
- ‚úÖ HSTS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (–≤–∫–ª—é—á–µ–Ω –≤ production, –æ—Ç–∫–ª—é—á–µ–Ω –≤ development)
- ‚úÖ –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ

---

## üìù –ó–∞–º–µ—Ç–∫–∏

- –í—Å–µ —Ç–µ—Å—Ç—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ Swagger UI –∏ curl
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–∞—è —Å—Ä–µ–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- Keycloak –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω
