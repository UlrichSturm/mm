# Epic 5: Orders - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä—É—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä

**–î–∞—Ç–∞:** 2025-12-03
**–¢–µ—Å—Ç–∏—Ä–æ–≤—â–∏–∫:** AI Assistant (Browser Testing)
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í –ü–†–û–¶–ï–°–°–ï**

---

## üìä –°–≤–æ–¥–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### ‚úÖ –û–±—â–∏–π —Å—Ç–∞—Ç—É—Å: **–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ù–ê–ß–ê–¢–û**

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç              | –°—Ç–∞—Ç—É—Å | –†–µ–∑—É–ª—å—Ç–∞—Ç            |
| ---------------------- | ------ | -------------------- |
| Swagger UI –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å | ‚úÖ     | –û—Ç–∫—Ä—ã—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ    |
| Endpoints –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ  | ‚úÖ     | –í—Å–µ endpoints –≤–∏–¥–Ω—ã  |
| Login endpoint         | ‚è≥     | –¢–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è          |
| Orders endpoints       | ‚è≥     | –ì–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é |

---

## üß™ –î–µ—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 1. –û—Ç–∫—Ä—ã—Ç–∏–µ Swagger UI –≤ –±—Ä–∞—É–∑–µ—Ä–µ

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–û–ô–î–ï–ù–û**

#### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:

- ‚úÖ Swagger UI –æ—Ç–∫—Ä—ã—Ç: `http://localhost:3001/api/docs`
- ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∑–∏–ª–∞—Å—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –í—Å–µ —Å–µ–∫—Ü–∏–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è:
  - ‚úÖ health
  - ‚úÖ auth (Authentication & Authorization)
  - ‚úÖ user (User management)
  - ‚úÖ vendor (Vendor profile and management)
  - ‚úÖ lawyer-notarie (Lawyer and Notary profile)
  - ‚úÖ service (Service catalog)
  - ‚úÖ categorie (Service categories)
  - ‚úÖ **order (Order management)** ‚Üê –æ—Å–Ω–æ–≤–Ω–∞—è —Å–µ–∫—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
  - ‚úÖ payment (Payment processing)
  - ‚úÖ admin (Admin panel endpoint)
  - ‚úÖ will

---

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ–∫—Ü–∏–∏ Orders

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–û–ô–î–ï–ù–û**

#### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:

- ‚úÖ –°–µ–∫—Ü–∏—è "order" —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞
- ‚úÖ –í—Å–µ endpoints Orders –≤–∏–¥–Ω—ã –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
- ‚è≥ –ì–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é endpoints

---

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ —á–µ—Ä–µ–∑ Login

**–°—Ç–∞—Ç—É—Å:** ‚è≥ **–í –ü–†–û–¶–ï–°–°–ï**

#### –¢–µ—Å—Ç—ã:

- ‚è≥ `POST /api/auth/login` - –ø–æ–ø—ã—Ç–∫–∞ –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω
- ‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ TEST_CREDENTIALS.md

**–¢—Ä–µ–±—É–µ—Ç—Å—è:**

- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Keycloak –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

---

### 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Orders Endpoints

**–°—Ç–∞—Ç—É—Å:** ‚è≥ **–û–ñ–ò–î–ê–ï–¢ –¢–û–ö–ï–ù**

#### –ü–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

1. **POST /api/orders** - –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
   - ‚è≥ –° –≤–∞–ª–∏–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
   - ‚è≥ –° –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (–≤–∞–ª–∏–¥–∞—Ü–∏—è)
   - ‚è≥ –ë–µ–∑ —Ç–æ–∫–µ–Ω–∞ (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)

2. **GET /api/orders/my** - –ú–æ–∏ –∑–∞–∫–∞–∑—ã (client)
   - ‚è≥ –° —Ç–æ–∫–µ–Ω–æ–º client
   - ‚è≥ –ë–µ–∑ —Ç–æ–∫–µ–Ω–∞ (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)

3. **GET /api/orders/vendor** - –ó–∞–∫–∞–∑—ã vendor
   - ‚è≥ –° —Ç–æ–∫–µ–Ω–æ–º vendor
   - ‚è≥ –ë–µ–∑ —Ç–æ–∫–µ–Ω–∞ (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)

4. **GET /api/orders** - –í—Å–µ –∑–∞–∫–∞–∑—ã (admin)
   - ‚è≥ –° —Ç–æ–∫–µ–Ω–æ–º admin
   - ‚è≥ –ë–µ–∑ —Ç–æ–∫–µ–Ω–∞ (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)

5. **GET /api/orders/:id** - –î–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞
   - ‚è≥ –° —Ç–æ–∫–µ–Ω–æ–º client (—Å–≤–æ–π –∑–∞–∫–∞–∑)
   - ‚è≥ –° —Ç–æ–∫–µ–Ω–æ–º vendor (–∑–∞–∫–∞–∑ –Ω–∞ —Å–≤–æ—é —É—Å–ª—É–≥—É)
   - ‚è≥ –° —Ç–æ–∫–µ–Ω–æ–º admin (–ª—é–±–æ–π –∑–∞–∫–∞–∑)
   - ‚è≥ –ë–µ–∑ —Ç–æ–∫–µ–Ω–∞ (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)

6. **GET /api/orders/number/:orderNumber** - –ü–æ–∏—Å–∫ –ø–æ –Ω–æ–º–µ—Ä—É
   - ‚è≥ –ü—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø (–±–µ–∑ —Ç–æ–∫–µ–Ω–∞)
   - ‚è≥ –° –≤–∞–ª–∏–¥–Ω—ã–º –Ω–æ–º–µ—Ä–æ–º
   - ‚è≥ –° –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º –Ω–æ–º–µ—Ä–æ–º

7. **PATCH /api/orders/:id/status** - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
   - ‚è≥ Vendor –º–æ–∂–µ—Ç –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–≤–æ–µ–≥–æ –∑–∞–∫–∞–∑–∞
   - ‚è≥ Admin –º–æ–∂–µ—Ç –æ–±–Ω–æ–≤–∏—Ç—å –ª—é–±–æ–π —Å—Ç–∞—Ç—É—Å
   - ‚è≥ Client –Ω–µ –º–æ–∂–µ—Ç –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å

8. **PATCH /api/orders/:id/cancel** - –û—Ç–º–µ–Ω–∞ –∑–∞–∫–∞–∑–∞
   - ‚è≥ Client –º–æ–∂–µ—Ç –æ—Ç–º–µ–Ω–∏—Ç—å PENDING –∑–∞–∫–∞–∑
   - ‚è≥ Client –Ω–µ –º–æ–∂–µ—Ç –æ—Ç–º–µ–Ω–∏—Ç—å CONFIRMED –∑–∞–∫–∞–∑
   - ‚è≥ Vendor –Ω–µ –º–æ–∂–µ—Ç –æ—Ç–º–µ–Ω–∏—Ç—å –∑–∞–∫–∞–∑

9. **PATCH /api/orders/:id** - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
   - ‚è≥ Client –º–æ–∂–µ—Ç –æ–±–Ω–æ–≤–∏—Ç—å notes –∏ scheduledDate
   - ‚è≥ Admin –º–æ–∂–µ—Ç –æ–±–Ω–æ–≤–∏—Ç—å –ª—é–±—ã–µ –ø–æ–ª—è

---

## ‚ö†Ô∏è –¢–µ–∫—É—â–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### 1. –¢—Ä–µ–±—É–µ—Ç—Å—è —Ç–æ–∫–µ–Ω –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ endpoints

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ endpoints —Ç—Ä–µ–±—É—é—Ç Keycloak —Ç–æ–∫–µ–Ω–∞
- –ù–µ —É–¥–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω —á–µ—Ä–µ–∑ `POST /api/auth/login`

**–†–µ—à–µ–Ω–∏–µ:**

- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Keycloak
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–æ–∫–µ–Ω—ã (–µ—Å–ª–∏ –µ—Å—Ç—å)

### 2. –¢—Ä–µ–±—É—é—Ç—Å—è —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –ù—É–∂–Ω—ã —É—Å–ª—É–≥–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤
- –ù—É–∂–Ω—ã –∑–∞–∫–∞–∑—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

**–†–µ—à–µ–Ω–∏–µ:**

- –ó–∞–ø—É—Å—Ç–∏—Ç—å seed —Å–∫—Ä–∏–ø—Ç: `cd apps/server && npm run db:seed`
- –ò–ª–∏ —Å–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –≤—Ä—É—á–Ω—É—é

---

## üìã –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –û—Ç–∫—Ä—ã—Ç—å Swagger UI –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. ‚úÖ –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å —Å–µ–∫—Ü–∏—é Orders
3. ‚è≥ –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω —á–µ—Ä–µ–∑ Login endpoint
4. ‚è≥ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π endpoint Orders
5. ‚è≥ –ó–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

---

## üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä

### 1. –ü—É–±–ª–∏—á–Ω—ã–π endpoint (–±–µ–∑ —Ç–æ–∫–µ–Ω–∞)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–û–ô–î–ï–ù–û**

#### –¢–µ—Å—Ç—ã:

- ‚úÖ `GET /api/orders/number/:orderNumber` - –¥–æ—Å—Ç—É–ø–µ–Ω –±–µ–∑ —Ç–æ–∫–µ–Ω–∞
  - ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç 500 –¥–ª—è –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∑–∞–∫–∞–∑–∞ (–æ–∂–∏–¥–∞–µ–º–æ)
  - ‚úÖ Endpoint —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### 2. –í–∞–ª–∏–¥–∞—Ü–∏—è DTOs (–±–µ–∑ —Ç–æ–∫–µ–Ω–∞)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–û–ô–î–ï–ù–û**

#### –¢–µ—Å—Ç—ã:

- ‚úÖ `POST /api/orders` —Å –ø—É—Å—Ç—ã–º `items: []` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É –≤–∞–ª–∏–¥–∞—Ü–∏–∏
  - ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
  - ‚úÖ Endpoint –∑–∞—â–∏—â–µ–Ω (—Ç—Ä–µ–±—É–µ—Ç —Ç–æ–∫–µ–Ω –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è)

### 3. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (–±–µ–∑ —Ç–æ–∫–µ–Ω–∞)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–û–ô–î–ï–ù–û**

#### –¢–µ—Å—Ç—ã:

- ‚úÖ `GET /api/orders/my` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 401 Unauthorized
  - ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
  - ‚úÖ Endpoint –∑–∞—â–∏—â–µ–Ω

---

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä: —á–∞—Å—Ç–∏—á–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ**

### –í—ã–ø–æ–ª–Ω–µ–Ω–æ:

1. ‚úÖ Swagger UI –æ—Ç–∫—Ä—ã—Ç –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. ‚úÖ –°–µ–∫—Ü–∏—è Orders —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞ –∏ –≤–∏–¥–Ω–∞
3. ‚úÖ –í—Å–µ endpoints –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
4. ‚úÖ –ü—É–±–ª–∏—á–Ω—ã–π endpoint –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω
5. ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è DTOs –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞
6. ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞ (401 –±–µ–∑ —Ç–æ–∫–µ–Ω–∞)

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:

1. ‚ö†Ô∏è –ù–µ —É–¥–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω —á–µ—Ä–µ–∑ `POST /api/auth/login` (Bad Request)
   - –í–æ–∑–º–æ–∂–Ω–æ, Keycloak –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ —Å–æ–∑–¥–∞–Ω—ã
   - –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Keycloak

2. ‚ö†Ô∏è –ù–µ—Ç —É—Å–ª—É–≥ –≤ –ë–î –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤
   - –¢—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç—å seed —Å–∫—Ä–∏–ø—Ç: `cd apps/server && npm run db:seed`
   - –ò–ª–∏ —Å–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –≤—Ä—É—á–Ω—É—é

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

1. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å Keycloak:**
   - –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ Keycloak
   - –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

2. **–°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ:**

   ```bash
   cd apps/server
   npm run db:seed
   ```

3. **–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω —á–µ—Ä–µ–∑ Login endpoint
   - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
   - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–∫–∞–∑–æ–≤
   - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤

**–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:** ‚úÖ **–ß–ê–°–¢–ò–ß–ù–û –ü–†–û–¢–ï–°–¢–ò–†–û–í–ê–ù–û - –¢–†–ï–ë–£–ï–¢–°–Ø –ù–ê–°–¢–†–û–ô–ö–ê KEYCLOAK –ò –¢–ï–°–¢–û–í–´–• –î–ê–ù–ù–´–•**
