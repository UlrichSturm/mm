# Epic 5: Orders - –ü–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–î–∞—Ç–∞:** 2025-12-03
**–¢–µ—Å—Ç–∏—Ä–æ–≤—â–∏–∫:** AI Assistant
**–°—Ç–∞—Ç—É—Å:** –í –ø—Ä–æ—Ü–µ—Å—Å–µ

---

## üìã –ü–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Swagger UI

- [ ] Swagger UI –¥–æ—Å—Ç—É–ø–µ–Ω
- [ ] Endpoints Orders –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
- [ ] DTOs –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] Enum OrderStatus –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è

### 2. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ (US-023)

- [ ] `POST /orders` - —Å–æ–∑–¥–∞–Ω–∏–µ —Å –≤–∞–ª–∏–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (–æ–¥–Ω–∞ —É—Å–ª—É–≥–∞)
- [ ] `POST /orders` - —Å–æ–∑–¥–∞–Ω–∏–µ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —É—Å–ª—É–≥–∞–º–∏
- [ ] `POST /orders` - –æ—à–∏–±–∫–∞ –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- [ ] `POST /orders` - –æ—à–∏–±–∫–∞ —Å –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–π —É—Å–ª—É–≥–æ–π
- [ ] `POST /orders` - –æ—à–∏–±–∫–∞ —Å –Ω–µ-APPROVED vendor
- [ ] `POST /orders` - –≤–∞–ª–∏–¥–∞—Ü–∏—è items (–ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤)
- [ ] `POST /orders` - –≤–∞–ª–∏–¥–∞—Ü–∏—è quantity (min: 1)
- [ ] `POST /orders` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ totalPrice —Å –Ω–∞–ª–æ–≥–æ–º

### 3. –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–∫–∞–∑–æ–≤ Client (US-024)

- [ ] `GET /orders/my` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–∞–∫–∞–∑—ã –∫–ª–∏–µ–Ω—Ç–∞
- [ ] `GET /orders/my` - –ø–∞–≥–∏–Ω–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] `GET /orders/my` - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å—É
- [ ] `GET /orders/my` - –æ—à–∏–±–∫–∞ –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- [ ] `GET /orders/my` - –æ—à–∏–±–∫–∞ –¥–ª—è vendor/admin

### 4. –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–∫–∞–∑–æ–≤ Vendor (US-025)

- [ ] `GET /orders/vendor` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–∞–∫–∞–∑—ã –Ω–∞ —É—Å–ª—É–≥–∏ vendor
- [ ] `GET /orders/vendor` - –ø–∞–≥–∏–Ω–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] `GET /orders/vendor` - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å—É
- [ ] `GET /orders/vendor` - –æ—à–∏–±–∫–∞ –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- [ ] `GET /orders/vendor` - –æ—à–∏–±–∫–∞ –¥–ª—è client

### 5. –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∑–∞–∫–∞–∑–æ–≤ Admin (US-026)

- [ ] `GET /orders` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ –∑–∞–∫–∞–∑—ã (admin)
- [ ] `GET /orders` - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ clientId
- [ ] `GET /orders` - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ vendorId
- [ ] `GET /orders` - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ status
- [ ] `GET /orders` - –æ—à–∏–±–∫–∞ –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- [ ] `GET /orders` - –æ—à–∏–±–∫–∞ –¥–ª—è client/vendor

### 6. –î–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞ (US-026)

- [ ] `GET /orders/:id` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞
- [ ] `GET /orders/:id` - client –≤–∏–¥–∏—Ç —Å–≤–æ–π –∑–∞–∫–∞–∑
- [ ] `GET /orders/:id` - vendor –≤–∏–¥–∏—Ç –∑–∞–∫–∞–∑ –Ω–∞ —Å–≤–æ—é —É—Å–ª—É–≥—É
- [ ] `GET /orders/:id` - admin –≤–∏–¥–∏—Ç –ª—é–±–æ–π –∑–∞–∫–∞–∑
- [ ] `GET /orders/:id` - 403 –¥–ª—è client —á—É–∂–æ–≥–æ –∑–∞–∫–∞–∑–∞
- [ ] `GET /orders/:id` - 403 –¥–ª—è vendor —á—É–∂–æ–π —É—Å–ª—É–≥–∏
- [ ] `GET /orders/:id` - 404 –¥–ª—è –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∑–∞–∫–∞–∑–∞
- [ ] `GET /orders/number/:orderNumber` - –ø–æ–∏—Å–∫ –ø–æ –Ω–æ–º–µ—Ä—É —Ä–∞–±–æ—Ç–∞–µ—Ç

### 7. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞ (US-027)

- [ ] `PATCH /orders/:id/status` - vendor –º–æ–∂–µ—Ç –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å
- [ ] `PATCH /orders/:id/status` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ —Å—Ç–∞—Ç—É—Å–æ–≤
- [ ] `PATCH /orders/:id/status` - PENDING ‚Üí CONFIRMED —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] `PATCH /orders/:id/status` - CONFIRMED ‚Üí IN_PROGRESS —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] `PATCH /orders/:id/status` - IN_PROGRESS ‚Üí COMPLETED —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] `PATCH /orders/:id/status` - –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–π –ø–µ—Ä–µ—Ö–æ–¥ - –æ—à–∏–±–∫–∞ 400
- [ ] `PATCH /orders/:id/status` - vendor –Ω–µ –º–æ–∂–µ—Ç –æ–±–Ω–æ–≤–∏—Ç—å —á—É–∂–æ–π –∑–∞–∫–∞–∑
- [ ] `PATCH /orders/:id/status` - client –Ω–µ –º–æ–∂–µ—Ç –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å
- [ ] `PATCH /orders/:id/status` - admin –º–æ–∂–µ—Ç –æ–±–Ω–æ–≤–∏—Ç—å –ª—é–±–æ–π –∑–∞–∫–∞–∑
- [ ] `PATCH /orders/:id/status` - completedAt —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ COMPLETED

### 8. –û—Ç–º–µ–Ω–∞ –∑–∞–∫–∞–∑–∞ (US-028)

- [ ] `PATCH /orders/:id/cancel` - client –º–æ–∂–µ—Ç –æ—Ç–º–µ–Ω–∏—Ç—å PENDING –∑–∞–∫–∞–∑
- [ ] `PATCH /orders/:id/cancel` - —Å—Ç–∞—Ç—É—Å –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ CANCELLED
- [ ] `PATCH /orders/:id/cancel` - cancelledAt —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è
- [ ] `PATCH /orders/:id/cancel` - –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å –Ω–µ-PENDING –∑–∞–∫–∞–∑
- [ ] `PATCH /orders/:id/cancel` - client –Ω–µ –º–æ–∂–µ—Ç –æ—Ç–º–µ–Ω–∏—Ç—å —á—É–∂–æ–π –∑–∞–∫–∞–∑
- [ ] `PATCH /orders/:id/cancel` - vendor –Ω–µ –º–æ–∂–µ—Ç –æ—Ç–º–µ–Ω–∏—Ç—å –∑–∞–∫–∞–∑

### 9. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ (–±–æ–Ω—É—Å)

- [ ] `PATCH /orders/:id` - client –º–æ–∂–µ—Ç –æ–±–Ω–æ–≤–∏—Ç—å notes
- [ ] `PATCH /orders/:id` - client –º–æ–∂–µ—Ç –æ–±–Ω–æ–≤–∏—Ç—å scheduledDate
- [ ] `PATCH /orders/:id` - –Ω–µ–ª—å–∑—è –æ–±–Ω–æ–≤–∏—Ç—å COMPLETED –∑–∞–∫–∞–∑
- [ ] `PATCH /orders/:id` - –Ω–µ–ª—å–∑—è –æ–±–Ω–æ–≤–∏—Ç—å CANCELLED –∑–∞–∫–∞–∑
- [ ] `PATCH /orders/:id` - –Ω–µ–ª—å–∑—è –æ–±–Ω–æ–≤–∏—Ç—å REFUNDED –∑–∞–∫–∞–∑

---

## üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Swagger UI

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–û–ô–î–ï–ù–û**

#### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:

- ‚úÖ Swagger UI –¥–æ—Å—Ç—É–ø–µ–Ω: `http://localhost:3001/api/docs`
- ‚úÖ –í—Å–µ endpoints Orders –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è:
  - `POST /api/orders` - —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
  - `GET /api/orders` - –≤—Å–µ –∑–∞–∫–∞–∑—ã (admin)
  - `GET /api/orders/my` - –º–æ–∏ –∑–∞–∫–∞–∑—ã (client)
  - `GET /api/orders/vendor` - –∑–∞–∫–∞–∑—ã vendor
  - `GET /api/orders/:id` - –¥–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞
  - `GET /api/orders/number/:orderNumber` - –ø–æ–∏—Å–∫ –ø–æ –Ω–æ–º–µ—Ä—É
  - `PATCH /api/orders/:id/status` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
  - `PATCH /api/orders/:id/cancel` - –æ—Ç–º–µ–Ω–∞ –∑–∞–∫–∞–∑–∞
  - `PATCH /api/orders/:id` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
- ‚úÖ DTOs –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è:
  - `CreateOrderDto` —Å –º–∞—Å—Å–∏–≤–æ–º `items`
  - `CreateOrderItemDto` —Å –ø–æ–ª—è–º–∏ serviceId, quantity, notes
  - `UpdateOrderStatusDto` —Å –ø–æ–ª–µ–º status
  - `UpdateOrderDto` —Å –ø–æ–ª—è–º–∏ notes, scheduledDate
- ‚úÖ Responses –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã (201, 200, 400, 401, 403, 404)
- ‚ö†Ô∏è Endpoints —Ç—Ä–µ–±—É—é—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (401 –±–µ–∑ —Ç–æ–∫–µ–Ω–∞ - –æ–∂–∏–¥–∞–µ–º–æ)

### 2. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ (US-023)

**–°—Ç–∞—Ç—É—Å:** ‚è≥ –í –ø—Ä–æ—Ü–µ—Å—Å–µ

#### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:

- ‚è≥ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...

### 3. –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–∫–∞–∑–æ–≤ Client (US-024)

**–°—Ç–∞—Ç—É—Å:** ‚è≥ –í –ø—Ä–æ—Ü–µ—Å—Å–µ

#### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:

- ‚è≥ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...

### 4. –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–∫–∞–∑–æ–≤ Vendor (US-025)

**–°—Ç–∞—Ç—É—Å:** ‚è≥ –í –ø—Ä–æ—Ü–µ—Å—Å–µ

#### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:

- ‚è≥ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...

### 5. –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∑–∞–∫–∞–∑–æ–≤ Admin (US-026)

**–°—Ç–∞—Ç—É—Å:** ‚è≥ –í –ø—Ä–æ—Ü–µ—Å—Å–µ

#### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:

- ‚è≥ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...

### 6. –î–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞ (US-026)

**–°—Ç–∞—Ç—É—Å:** ‚è≥ –í –ø—Ä–æ—Ü–µ—Å—Å–µ

#### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:

- ‚è≥ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...

### 7. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞ (US-027)

**–°—Ç–∞—Ç—É—Å:** ‚è≥ –í –ø—Ä–æ—Ü–µ—Å—Å–µ

#### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:

- ‚è≥ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...

### 8. –û—Ç–º–µ–Ω–∞ –∑–∞–∫–∞–∑–∞ (US-028)

**–°—Ç–∞—Ç—É—Å:** ‚è≥ –í –ø—Ä–æ—Ü–µ—Å—Å–µ

#### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:

- ‚è≥ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...

### 9. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ (–±–æ–Ω—É—Å)

**–°—Ç–∞—Ç—É—Å:** ‚è≥ –í –ø—Ä–æ—Ü–µ—Å—Å–µ

#### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:

- ‚è≥ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...

---

## üìù –ó–∞–º–µ—Ç–∫–∏

- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ Swagger UI –∏ curl
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–∞—è —Å—Ä–µ–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- Keycloak –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω
- –¢—Ä–µ–±—É—é—Ç—Å—è —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ (—É—Å–ª—É–≥–∏, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)

---

## ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **–¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:**
   - –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ endpoints —Ç—Ä–µ–±—É—é—Ç Keycloak —Ç–æ–∫–µ–Ω–∞
   - –ù—É–∂–Ω—ã —Ç–µ—Å—Ç–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å —Ä–æ–ª—è–º–∏ client, vendor, admin

2. **–¢—Ä–µ–±—É—é—Ç—Å—è —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ:**
   - –ù—É–∂–Ω—ã —É—Å–ª—É–≥–∏ (Services) –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤
   - –ù—É–∂–Ω—ã APPROVED vendors
   - –ù—É–∂–Ω—ã ACTIVE services

3. **Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:**
   - –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã (TODO –≤ –∫–æ–¥–µ)
   - –ù–µ –±—É–¥—É—Ç –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

1. ‚úÖ –í—Å–µ endpoints –¥–æ—Å—Ç—É–ø–Ω—ã –≤ Swagger
2. ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç (403 –¥–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö/–Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö)
4. ‚úÖ –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç (–ø–µ—Ä–µ—Ö–æ–¥—ã —Å—Ç–∞—Ç—É—Å–æ–≤, —Ä–∞—Å—á–µ—Ç—ã)
5. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç (client/vendor/admin)
