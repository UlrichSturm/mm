# Epic 12: Client App - Payments

**Phase:** MVP  
**Portal:** Client App  
**Module:** Payments  
**Epic ID:** E-012

---

## Описание

Процесс оплаты в клиентском приложении. Включает интеграцию со Stripe, страницу оплаты и обработку платежей.

---

## Функциональность

- Страница оплаты
- Интеграция со Stripe (Stripe Elements)
- Ввод платежных данных
- Подтверждение платежа
- Статусы платежей
- История платежей

**Исключено из MVP:**
- Сохранение платежных методов
- Escrow статус (будет в Phase 2)
- Dispute resolution

---

## Зависимости

**Предшествующие эпики:**
- ✅ Epic 6: Backend Payments (MUST)
- ✅ Epic 11: Client App - Orders (MUST)

**Требует завершения:**
- Epic 6 должен быть завершен (Backend API готов)
- Epic 11 должен быть завершен (Orders для связи)

**Блокирует:**
- Epic 24: Client App - Escrow Payments (Phase 2)

---

## Приоритет (MoSCoW)

**Must Have** - Критичный для MVP

Платежи - это критичная функция для монетизации. Без них клиенты не могут оплатить заказы.

---

## Story Points

**Оценка:** 13 points

**Обоснование:**
- Страница оплаты: 4 points
- Интеграция со Stripe: 5 points
- Обработка платежей: 2 points
- История платежей: 2 points

---

## Последовательность разработки

**Порядок:** 12 (после Epic 6, 11)

**Последовательность:**
1. Настройка Stripe Elements
2. Страница оплаты
3. Интеграция с Backend API
4. Обработка платежей
5. Статусы платежей
6. История платежей

---

## Параллельная разработка

**Возможна параллельная работа:**
- ✅ UI/UX дизайн может быть готов заранее
- ✅ История платежей может разрабатываться параллельно

**Не может быть параллельной:**
- ❌ Нужна интеграция с Epic 6, 11
- ❌ Нужна настройка Stripe

---

## Критерии готовности (Definition of Done)

- [ ] Страница оплаты работает
- [ ] Интеграция со Stripe работает
- [ ] Платежи обрабатываются
- [ ] Статусы платежей отображаются
- [ ] История платежей работает
- [ ] Безопасность платежей обеспечена
- [ ] Responsive дизайн
- [ ] Тестирование в Stripe test mode пройдено
- [ ] Code review пройден

---

## User Stories (примеры)

1. **Как Client**, я хочу оплатить заказ, чтобы получить услугу
2. **Как Client**, я хочу видеть статус моего платежа
3. **Как Client**, я хочу видеть историю моих платежей
4. **Как система**, я должна безопасно обрабатывать платежные данные

---

## Технические детали

**Технологии:**
- Next.js 14
- TypeScript
- Tailwind CSS
- Stripe Elements (React)
- Stripe.js

**Страницы:**
- `/payments/:orderId` - Страница оплаты
- `/payments` - История платежей
- `/payments/:id` - Детали платежа

**API Integration:**
- `POST /payments/intent` - Создание Payment Intent
- `POST /payments/confirm` - Подтверждение платежа
- `GET /payments` - История платежей

**Stripe:**
- Stripe Elements для формы оплаты
- Stripe.js для обработки
- Test mode для разработки

---

## Риски и митигация

**Риски:**
- Сложность интеграции со Stripe
- Безопасность платежных данных
- PCI compliance

**Митигация:**
- Использование Stripe Elements (PCI compliant)
- Следование best practices Stripe
- Тщательное тестирование

---

## Примечания

Критичный эпик для MVP. Без платежей платформа не может монетизироваться.

